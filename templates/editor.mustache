<!DOCTYPE html>
<title>{{docname}} - GitDox: Edit</title>
<meta charset="utf-8"/>


<head>
    <link rel="stylesheet" href="{{skin_stylesheet}}" type="text/css" charset="utf-8"/>
    <link rel="stylesheet" href="css/gitdox.css?version=3" type="text/css" charset="utf-8"/>
    <link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css"/>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=800">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/editor.js?version=4"></script>

    <!-- for jtable -->
    <link rel="stylesheet" href="js/jquery-ui-1.12.1/jquery-ui.min.css"/>
    <link rel="stylesheet" href="js/jtable.2.4.0/themes/lightcolor/gray/jtable.min.css" type="text/css" />
    <script src="js/jquery-ui-1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="js/jtable.2.4.0/jquery.jtable.min.js" type="text/javascript"></script>

    <!--The following script tag downloads a font from the Adobe Edge Web Fonts server for use within the web page. We recommend that you do not modify it.-->
    <script>var __adobewebfontsappname__="dreamweaver"</script>
    <link rel="stylesheet" href="https://use.edgefonts.net/c/dbcb1c/1w;asul,2,WXx:W:n4/l" media="all">
    <script src="https://use.edgefonts.net/asul:n4:default.js" type="text/javascript"></script>

    <script src="js/validate.js"></script>
</head>
<body>
    {{{navbar_html}}}
    <div id="wrapper">
        <div id="header">
            {{> header}}
        </div>
        <div id="content">
            <h1>GitDox: Edit</h1>
            {{{ editor_help_link_html }}}
            <hr>

            <div>
                <link rel="stylesheet" href="codemirror-5.15.2/lib/codemirror.css">
                <link rel="stylesheet" href="codemirror-5.15.2/addon/hint/show-hint.css">
                <script src="codemirror-5.15.2/lib/codemirror.js"></script>
                <script src="codemirror-5.15.2/addon/hint/show-hint.js"></script>
                <script src="codemirror-5.15.2/addon/hint/xml-hint.js"></script>
                <script src="codemirror-5.15.2/mode/xml/xml.js"></script>
                <style type="text/css">
                 .CodeMirror { border: 1px solid #eee; }
                </style>



                {{#doc_is_selected}}
                <article>
                    <form name="hiddenForm" id="editor_form" method="post" action="editor.py" enctype="multipart/form-data">
                        <input type="hidden" name="id" id="id" value="{{id}}">
                        <input type="hidden" name="mode" id="mode" value="{{mode}}">
                        <input type="hidden" name="schema" id="schema" value="{{schema}}">
                        <input type="hidden" name="nlp_xml" id="nlp_xml">
                        <input type="hidden" name="nlp_spreadsheet" id="nlp_spreadsheet">
                        <h2>Editor | <a href="index.py">back to document list</a> </h2>

                        <table id="doc_data" style="background:#eee;padding:5pt;">
                            <colgroup>
                                <col style="width:150px">
                            </colgroup>
                            <tbody>
                                <tr>
                                    <td>Document Name: </td>
                                    <td>
                                        <input type="text" id="edit_docname" name="edit_docname"
                                               defaultValue="{{docname}}" value="{{docname}}"
                                               {{^can_save}}disabled="disabled" class="disabled"{{/can_save}}
                                               onblur="validate_docname();">
                                        {{#can_save}}
                                        <div onclick="document.getElementById('editor_form').submit();" class="button slim">
                                            <i class="fa fa-floppy-o"> </i>
                                        </div>
                                        {{/can_save}}
                                    </td>
                                    <td>
                                        <div class="button" id="validate_editor" onclick="validate_doc();">Validate</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Corpus Name: </td>
                                    <td>
                                        <input type="text" id="edit_corpusname" name="edit_corpusname"
                                               defaultValue="{{corpusname}}" value="{{corpusname}}"
                                               {{^can_save}}disabled="disabled" class="disabled"{{/can_save}}
                                               onblur="validate_corpusname();">
                                        {{#can_save}}
                                        <div onclick="document.getElementById('editor_form').submit();" class="button slim">
                                            <i class="fa fa-floppy-o"> </i>
                                        </div>
                                        {{/can_save}}
                                    </td>
                                    <td rowspan="6" class="report_container">
                                        <div id="validation_report">
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Git Repo: </td>
                                    <td>
                                        <input type="text" id="edit_filename" name="edit_filename"
                                               value="{{repo}}" defaultValue="{{repo}}"
                                               {{^can_save}}disabled="disabled" class="disabled"{{/can_save}}
                                               onblur="validate_repo();">
                                        {{#can_save}}
                                        <div onclick="document.getElementById('editor_form').submit();" class="button slim">
                                            <i class="fa fa-floppy-o"> </i>
                                        </div>
                                        {{/can_save}}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Assigned to:</td>
                                    <td>
                                        {{{edit_assignee_html}}}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Status:</td>
                                    <td>
                                        {{{edit_status_html}}}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Mode:</td>
                                    <td>
                                        {{{edit_mode_html}}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        {{#ether_mode}}
                            {{> ethercalc}}
                        {{/ether_mode}}
                        {{^ether_mode}}
                            {{> codemirror}}
                        {{/ether_mode}}

                        <ul class="tabs" style="margin-top: 18px;">
                            <li data-tab="metadata-table-container" class="tab-link current">Document Metadata</li>
                            <li data-tab="corpus-metadata-table-container" class="tab-link">Corpus Metadata</li>
                        </ul>
                        <div id="metadata-table-container" class="tab-content current" style="max-width: 1000px;"></div>
                        <div id="corpus-metadata-table-container" class="tab-content" style="max-width: 1000px;"></div>

                        <input type="hidden" name="metakey">
                        <input type="hidden" name="metavalue">
                        <br/><br/>
                        {{{corpus_metadata_html}}}

                        <input type="hidden" name="corpus_metakey">
                        <input type="hidden" name="corpus_metavalue">
                        <br/><br/>

                        <div class="button corpusbutton" onClick="openPopup('popupPageCorpus.html')"><i class="fa fa-info-circle"> </i> Add Corpus Metadata</div>

                    </form>

                    <div style="width:400px;padding-top:24px;">
                        <form id="form_clone" action="editor.py">
                            <input type="hidden" name="id" id="id" value="{{id}}"/>
                            {{#admin_gt_zero}}
                            <select id="source_doc" name="source_doc" style="width: 240px;">
                                <option value="">-- Select document to clone --</option>
                                {{#docs}}
                                    <option value="{{id}}">{{name}} ({{corpus}})</option>
                                {{/docs}}
                            </select>
                            {{/admin_gt_zero}}
                            {{^admin_gt_zero}}
                            <select id="source_doc" name="source_doc" style="width: 240px;" disabled="disabled">
                                <option value="">-- Select document to clone --</option>
                            </select>
                            {{/admin_gt_zero}}
                            <br/>
                            <button type="button" id="clone_doc"
                                    onclick="document.getElementById('form_clone').submit();"
                                    class="button disabled" disabled="disabled" style="width:100%;">
                                <i class="fa fa-copy"></i>
                                Copy Document Metadata
                            </button>
                        </form>
                        <script>
                         // disable clone button if no doc is selected
                         window.addEventListener("load", function() {
                             var sourceDoc = document.getElementById("source_doc");
                             var cloneDoc = document.getElementById("clone_doc");
                             if (sourceDoc.value === "") {
                                 cloneDoc.setAttribute("disabled", "disabled");
                                 cloneDoc.className = "button disabled";
                             }
                             else {
                                 cloneDoc.removeAttribute("disabled");
                                 cloneDoc.className = "button";
                             }
                         });
                         document.getElementById("source_doc").addEventListener("input", function(event) {
                             var cloneDoc = document.getElementById("clone_doc");
                             var v = event.target.value;
                             if (v === "") {
                                 cloneDoc.setAttribute("disabled", "disabled");
                                 cloneDoc.className = "button disabled";
                             }
                             else {
                                 cloneDoc.removeAttribute("disabled");
                                 cloneDoc.className = "button";
                             }
                         });
                        </script>
                    </div>

                </article>
                {{/doc_is_selected}}
                {{^doc_is_selected}}
                <h2>No document selected | <a href="index.py">back to document list</a> </h2>
                {{/doc_is_selected}}
            </div>
        </div>
    </div>
</body>

