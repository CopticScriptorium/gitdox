<script type="text/javascript" src="codemirror-5.15.2/addon/search/search.js"></script>
<script type="text/javascript" src="codemirror-5.15.2/addon/search/searchcursor.js"></script>
<script type="text/javascript" src="codemirror-5.15.2/addon/search/jump-to-line.js"></script>
<script type="text/javascript" src="codemirror-5.15.2/addon/dialog/dialog.js"></script>
<link rel="stylesheet" type="text/css" href="codemirror-5.15.2/addon/dialog/dialog.css">

<textarea id="code" name="code">**content**</textarea>
<div class="button h128" onclick="do_save();" ><i class="fa fa-floppy-o"> </i> Save</div> **NLP**  **github**

    <script>


      var tags = {
  "!top": [
    "text",
    "head",
    "lg",
    "sp",
    "s",
    "incident",
    "date",
    "gap",
    "measure",
    "sic",
    "w",
    "time",
    "quote",
    "figure",
    "caption",
    "p",
    "list",
    "item",
    "add",
    "l",
    "hi",
    "q",
    "ref"
  ],
  "text": {
    "attrs": {
      "id": null,
      "type": [
        "interview",
        "news",
        "voyage",
        "whow",
        "academic",
        "bio",
        "reddit",
        "fiction"
      ]
    },
    "children": [
      "figure",
      "list",
      "p",
      "quote",
      "s",
      "head",
      "sp",
      "incident"
    ]
  },
  "head": {
    "attrs": {
      "rend": null
    },
    "children": [
      "s"
    ]
  },
  "lg": {
    "attrs": {
      "type": null,
      "n": null
    },
    "children": [
      "s"
    ]
  },
  "sp": {
    "attrs": {
      "who": null
    },
    "children": [
      "s",
      "list",
      "p",
      "hi"
    ]
  },
  "s": {
    "attrs": {
      "type": [
        "decl",
        "sub",
        "imp",
        "q",
        "wh",
        "inf",
        "ger",
        "intj",
        "frag",
        "other"
      ]
    },
    "children": [
      "add",
      "figure",
      "hi",
      "sp",
      "q",
      "w",
      "quote",
      "ref",
      "date",
      "gap",
      "incident",
      "l",
      "list",
      "measure",
      "sic",
      "time"
    ]
  },
  "incident": {
    "attrs": {
      "type": null,
      "who": null
    }
  },
  "date": {
    "attrs": {
      "from": null,
      "notAfter": null,
      "notBefore": null,
      "rend": null,
      "to": null,
      "when": null
    }
  },
  "gap": {
    "attrs": {
      "reason": null
    }
  },
  "measure": {
    "attrs": {
      "type": null
    }
  },
  "sic": {
    "children": [
      "ref",
      "w"
    ]
  },
  "w": {},
  "time": {
    "attrs": {
      "when": null,
      "from": null,
      "to": null
    }
  },
  "quote": {
    "attrs": {
      "rend": null
    },
    "children": [
      "add",
      "q",
      "ref",
      "s",
      "sic"
    ]
  },
  "figure": {
    "attrs": {
      "rend": null
    },
    "children": [
      "caption"
    ]
  },
  "caption": {
    "attrs": {
      "rend": null
    },
    "children": [
      "quote",
      "s"
    ]
  },
  "p": {
    "attrs": {
      "rend": null
    },
    "children": [
      "add",
      "figure",
      "hi",
      "lg",
      "quote",
      "list",
      "s",
      "sp"
    ]
  },
  "list": {
    "attrs": {
      "type": [
        "ordered",
        "unordered"
      ]
    },
    "children": [
      "figure",
      "item"
    ]
  },
  "item": {
    "attrs": {
      "n": null
    },
    "children": [
      "head",
      "figure",
      "ref",
      "hi",
      "list",
      "p",
      "s"
    ]
  },
  "add": {
    "children": [
      "s",
      "ref"
    ]
  },
  "l": {
    "attrs": {
      "n": null
    },
    "children": [
      "s",
      "date"
    ]
  },
  "hi": {
    "attrs": {
      "rend": null
    },
    "children": [
      "ref",
      "incident",
      "w",
      "lg",
      "s",
      "caption",
      "q",
      "sic"
    ]
  },
  "q": {
    "children": [
      "figure",
      "hi",
      "sic",
      "ref"
    ]
  },
  "ref": {
    "attrs": {
      "target": null,
      "rend": null
    },
    "children": [
      "add",
      "hi",
      "sic",
      "date"
    ]
  }
}
;

      function completeAfter(cm, pred) {
        var cur = cm.getCursor();
        if (!pred || pred()) setTimeout(function() {
          if (!cm.state.completionActive)
            cm.showHint({completeSingle: false});
        }, 100);
        return CodeMirror.Pass;
      }

      function completeIfAfterLt(cm) {
        return completeAfter(cm, function() {
          var cur = cm.getCursor();
          return cm.getRange(CodeMirror.Pos(cur.line, cur.ch - 1), cur) == "<";
        });
      }

      function completeIfInTag(cm) {
        return completeAfter(cm, function() {
          var tok = cm.getTokenAt(cm.getCursor());
          if (tok.type == "string" && (!/['"]/.test(tok.string.charAt(tok.string.length - 1)) || tok.string.length == 1)) return false;
          var inner = CodeMirror.innerMode(cm.getMode(), tok.state).state;
          return inner.tagName;
        });
      }

      var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        mode: "xml",
        lineNumbers: true,indentUnit:0,lineWrapping:true,
        extraKeys: {
          "'<'": completeAfter,
          "'/'": completeIfAfterLt,
          "' '": completeIfInTag,
          "'='": completeIfInTag,
          "Ctrl-Space": "autocomplete"
        },
        hintOptions: {schemaInfo: tags}
      });

	  function updateTextArea() {
	      editor.save();
	  }
	  editor.on('change', updateTextArea);
	  
	  delete CodeMirror.keyMap.emacsy["Alt-F"]; delete CodeMirror.keyMap.emacsy["Alt-D"];


    </script>
